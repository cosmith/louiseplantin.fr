{"version":3,"sources":["utils.js","index.js"],"names":["randInt","min","max","Math","floor","random","getBounds","image","x","y","top","bottom","height","left","right","width","intersects","otherImage","otherX","otherY","margin","bounds","otherBounds","images","number","count","push","src","concat","title","generateImages","GRID_SIZE","ZOOM_SPEED","INITIAL_ZOOM","MIN_ZOOM","MAX_ZOOM","MOVE_SPEED","generatePositions","positions","forEach","theta","radius","hasIntersection","PI","cos","sin","i","length","position","document","body","addEventListener","e","preventDefault","render","react_default","a","createElement","zoomLevel","useRef","_useSpring","useSpring","xys","_useSpring2","Object","slicedToArray","propsMap","setPropsMap","initialPositions","_useSprings","useSprings","xy","display","_useSprings2","propsImages","setImages","bind","useGesture","onDrag","_ref","_ref$vxvy","vxvy","vx","vy","current","onPinch","_ref2","_ref2$delta","delta","yDelta","clamp","onWheel","_ref3","_ref3$delta","assign","id","className","onClick","web","div","style","transform","interpolate","s","map","_ref4","key","backgroundImage","font-size","getElementById"],"mappings":"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","file":"static/js/main.73a8f3ef.chunk.js","sourcesContent":["export function randInt(min, max) {\n    return Math.floor(Math.random() * (max - min)) + min;\n}\n\nexport function getBounds(image, x, y) {\n    return {\n        top: y,\n        bottom: y + image.height,\n        left: x,\n        right: x + image.width,\n    };\n}\n\nexport function intersects(image, x, y, otherImage, otherX, otherY, margin) {\n    const bounds = getBounds(image, x, y);\n    const otherBounds = getBounds(otherImage, otherX, otherY);\n    return (\n        bounds.left - margin < otherBounds.right &&\n        bounds.right + margin > otherBounds.left &&\n        bounds.top - margin < otherBounds.bottom &&\n        bounds.bottom + margin > otherBounds.top\n    );\n}\n","import {render} from \"react-dom\";\nimport React, {useRef} from \"react\";\nimport {useSpring, useSprings, animated} from \"react-spring\";\nimport {useGesture} from \"react-use-gesture\";\nimport {clamp} from \"lodash-es\";\n\nimport {randInt, intersects} from \"./utils\";\nimport \"./styles.css\";\n\nfunction generateImages(number) {\n    let count = 0;\n    const images = [];\n    while (count < number) {\n        count = count + 1;\n        const width = randInt(500, 2000);\n        const height = randInt(500, 2000);\n\n        images.push({\n            width: width,\n            height: height,\n            src: `https://placekitten.com/${width}/${height}/`,\n            title: \"Test\",\n        });\n    }\n    return images;\n}\n\nconst images = generateImages(20);\n\nconst GRID_SIZE = 200;\nconst ZOOM_SPEED = 1.2;\nconst INITIAL_ZOOM = 0.2;\nconst MIN_ZOOM = 0.2;\nconst MAX_ZOOM = 2;\nconst MOVE_SPEED = 20;\n\nfunction generatePositions(images) {\n    const positions = [];\n\n    images.forEach(image => {\n        let x = randInt(-50, 50) * GRID_SIZE;\n        let y = randInt(-50, 50) * GRID_SIZE;\n        let theta = 0;\n        let radius = 0;\n\n        let hasIntersection = true;\n\n        while (hasIntersection) {\n            hasIntersection = false;\n            theta += (randInt(10, 25) / 180) * Math.PI;\n            if (theta > Math.PI * 2) {\n                radius += 50;\n            }\n            x = Math.floor(Math.cos(theta) * radius);\n            y = Math.floor(Math.sin(theta) * radius);\n            for (let i = 0; i < positions.length; i++) {\n                let position = positions[i];\n                hasIntersection =\n                    hasIntersection ||\n                    intersects(image, x, y, images[i], position[0], position[1], 50);\n            }\n        }\n\n        positions.push([x, y]);\n    });\n    return positions;\n}\n\nfunction Viewpager() {\n    const zoomLevel = useRef(INITIAL_ZOOM);\n    const position = useRef({x: 0, y: 0});\n\n    const [propsMap, setPropsMap] = useSpring(() => {\n        return {xys: [0, 0, INITIAL_ZOOM]}; // x, y, scale\n    });\n\n    const initialPositions = generatePositions(images);\n\n    const [propsImages, setImages] = useSprings(images.length, i => ({\n        xy: initialPositions[i],\n        display: \"block\",\n    }));\n\n    const bind = useGesture({\n        onDrag: ({vxvy: [vx, vy]}) => {\n            position.current = {\n                x: (vx * MOVE_SPEED) / zoomLevel.current + position.current.x,\n                y: (vy * MOVE_SPEED) / zoomLevel.current + position.current.y,\n            };\n            setPropsMap({xys: [position.current.x, position.current.y, zoomLevel.current]});\n        },\n        onPinch: ({delta: [xDelta, yDelta]}) => {\n            zoomLevel.current = clamp(\n                yDelta > 0 ? ZOOM_SPEED * zoomLevel.current : zoomLevel.current / ZOOM_SPEED,\n                MIN_ZOOM,\n                MAX_ZOOM\n            );\n            setPropsMap({xys: [position.current.x, position.current.y, zoomLevel.current]});\n        },\n        onWheel: ({delta: [xDelta, yDelta]}) => {\n            zoomLevel.current = clamp(\n                yDelta < 0 ? ZOOM_SPEED * zoomLevel.current : zoomLevel.current / ZOOM_SPEED,\n                MIN_ZOOM,\n                MAX_ZOOM\n            );\n            setPropsMap({xys: [position.current.x, position.current.y, zoomLevel.current]});\n        },\n    });\n\n    return (\n        <div {...bind()} id=\"container\">\n            <div\n                id=\"shuffle\"\n                className=\"chrome\"\n                onClick={() => {\n                    const positions = generatePositions(images);\n                    setImages(i => {\n                        return {\n                            xy: positions[i],\n                            display: \"block\",\n                        };\n                    });\n                }}\n            >\n                shuffle\n            </div>\n            <animated.div\n                style={{\n                    transform: propsMap.xys.interpolate(\n                        (x, y, s) => `scale(${s}) translate3d(${x}px,${y}px,0)`\n                    ),\n                }}\n                id=\"map\"\n            >\n                {propsImages.map(({xy, display}, i) => (\n                    <animated.div\n                        className=\"image-container\"\n                        key={i}\n                        style={{\n                            display,\n                            transform: xy.interpolate((x, y) => `translate3d(${x}px,${y}px,0)`),\n                        }}\n                    >\n                        <animated.div\n                            className=\"image\"\n                            style={{\n                                width: `${images[i].width}px`,\n                                height: `${images[i].height}px`,\n                                backgroundImage: `url(${images[i].src})`,\n                            }}\n                        />\n                        <animated.div\n                            className=\"legend\"\n                            style={{\n                                \"font-size\": propsMap.xys.interpolate((x, y, s) => `${25 / s}px`),\n                            }}\n                        >\n                            {images[i].title}\n                        </animated.div>\n                    </animated.div>\n                ))}\n            </animated.div>\n        </div>\n    );\n}\n\ndocument.body.addEventListener(\"touchmove\", function(e) {\n    e.preventDefault();\n});\n\nrender(<Viewpager />, document.getElementById(\"root\"));\n"],"sourceRoot":""}